var FormField={GetField:function(e){if(isNaN(e)&&"object"==typeof e&&(e=parseInt($(e).attr("id").substr(10))),""==e||isNaN(e))return!1;var t=$("#FormField_"+e),i=$(t).length;return 0==i?!1:(i>1&&(t=$(t).get(i-1)),$(t))},GetFieldByPrivateId:function(e,t){if(isNaN(e)||1>e||""==t)return!1;var i=$(".FormFieldPrivateId[value="+t+"]").parent("*:has(.FormFieldFormId[value="+e+"])").find(".FormField");return i.length?i[0]:!1},GetFieldByLabel:function(e,t){if(isNaN(e)||1>e||""==t)return!1;var i=!1;return $(".FormField").each(function(){FormField.GetFieldFormId(this)==e&&FormField.GetLabel(this)==t&&(i=$(this))}),i},GetFieldType:function(e){var t=FormField.GetFieldDefinitionData(e);return t?$(".FormFieldType",t).val():""},GetFieldId:function(e){var t=FormField.GetFieldDefinitionData(e);return t?$(".FormFieldId",t).val():""},GetFieldFormId:function(e){var t=FormField.GetFieldDefinitionData(e);return t?$(".FormFieldFormId",t).val():""},GetSelectorChoosePrefix:function(e){var t=FormField.GetFieldDefinitionData(e);return t&&$(".FormFieldChoosePrefix",t).length?$(".FormFieldChoosePrefix",t).val():""},GetFieldPrivateId:function(e){var t=FormField.GetFieldDefinitionData(e);return t?$(".FormFieldPrivateId",t).val():""},GetFieldDefinitionData:function(e){var t=$(e).parent("dd");return t.length||(t=$(e).parent("div.value")),t.length?t:!1},GetFieldDefinitionTag:function(e){var t=FormField.GetFieldDefinitionData(e);if(!t)return!1;var i=t.prev("dt");return i.length||(i=t.prev("label")),i?i:!1},GetValue:function(e){var t=FormField.GetField(e);if(!t)return"";switch(FormField.GetFieldType(t).toLowerCase()){case"radioselect":case"checkboxselect":var i=[];return $(".FormFieldOption:checked",t).each(function(){i[i.length]=$(this).val()}),0==i.length?"radioselect"==FormField.GetFieldType(t).toLowerCase()?"":[]:("radioselect"==FormField.GetFieldType(t).toLowerCase()&&(i=i[0]),i);case"datechooser":var r=$(".FormFieldDay",t).val(),a=$(".FormFieldMonth",t).val(),l=$(".FormFieldYear",t).val();return""==r||""==a||""==l?"":(1==r.length&&(r="0"+r),1==a.length&&(a="0"+a),l+"-"+a+"-"+r);default:return $(t).val()}},GetValues:function(e,t){var i=[];("undefined"==typeof t||t!==!0)&&(t=!1),isNaN(e)||(e=[e]);for(var r=e.length;r--;){var a=e[r];$(".FormFieldFormId[value="+a+"]").parent("dd, div.value").find(".FormField").each(function(){if(!t||""!=FormField.GetFieldPrivateId(this))for(var r=0;r<e.length;r++)i[i.length]={field:$(this),fieldId:FormField.GetFieldId(this),formId:a,privateId:FormField.GetFieldPrivateId(this),label:FormField.GetLabel(this),value:FormField.GetValue(this)}})}return i},SetValue:function(e,t,i){var r=FormField.GetField(e);if(!r)return!1;switch("undefined"==typeof i&&(i={}),FormField.GetFieldType(r).toLowerCase()){case"selectortext":if("undefined"==typeof i.display&&(i.display="select"),i.display!=r.get(0).tagName.toLowerCase()){if("select"==i.display)var a=$("<select />");else var a=$('<input type="text" />');if($(a).attr("name",$(r).attr("name")),$(a).attr("class",$(r).attr("class")),$(a).attr("id",$(r).attr("id")),$(a).attr("style",$(r).attr("style")),$(r).replaceWith(a),"select"!==i.display){var e=FormField.GetFieldId(e),l=FormField.GetFieldFormId(e);$(a).after('<input type="hidden" name="FormFieldIsText['+l+"]["+e+']" value="1" />')}}else var a=r;"undefined"!=typeof i.options&&FormField.SetOptions(e,i.options),$(a).val(t);break;case"radioselect":case"checkboxselect":"undefined"!=typeof i.options&&FormField.SetOptions(e,i.options),"string"==typeof t?t=[t]:"radioselect"==FormField.GetFieldType(r).toLowerCase()&&t.length>1&&(t.length=1),$(".FormFieldOption",r).each(function(){for(var e=!1,i=0;i<t.length;i++)if($(this).attr("value")==t[i]){e=!0;break}$(this).attr("checked",e)});break;case"datechooser":if(-1==t.indexOf("-"))return!1;var o=t.split("-");if(3!==o.length)return!1;var n=parseInt(o[0],10),d=parseInt(o[1],10),s=parseInt(o[2],10);if(isNaN(s)||isNaN(d)||isNaN(n))return!1;$(".FormFieldYear",r).val(n),$(".FormFieldMonth",r).val(d),$(".FormFieldDay",r).val(s);break;default:"singleselect"==FormField.GetFieldType(r).toLowerCase()&&"undefined"!=typeof i.options&&FormField.SetOptions(e,i.options),$(r).val(t)}},SetValueByIndex:function(e,t,i){var r=FormField.GetField(e);if(!r)return!1;if("checkboxselect"!==FormField.GetFieldType(r).toLowerCase()||"radioselect"==FormField.GetFieldType(r).toLowerCase())return!0;if("object"!=typeof t&&(t=[t]),0==t.length)return!0;"undefined"==typeof i&&(i=!0),i=i!==!0?!1:!0;var a=0;$("input",r).each(function(){for(var e=0;e<t.length;e++)if(t[e]==a){$(this).attr("checked",i);break}a++})},GetOptions:function(e,t){var i=FormField.GetField(e);if(!i)return!1;switch(("undefined"==typeof t||t!==!0)&&(t=!1),FormField.GetFieldType(i).toLowerCase()){case"selectortext":case"singleselect":if("input"==$(i).get(0).tagName)return[];var r=[];return $("option",i).each(function(){""!==$(this).val()&&(r[r.length]=$(this).val())}),r;case"radioselect":case"checkboxselect":var r=[];return $("input",i).each(function(){""!==$(this).val()&&(r[r.length]=$(this).val())}),r;default:return[]}},SetOptions:function(e,t){var i=FormField.GetField(e);if(!i)return!1;switch("string"==typeof t&&(t=[t]),FormField.GetFieldType(i).toLowerCase()){case"selectortext":case"singleselect":var r=FormField.GetSelectorChoosePrefix(i);$(i).empty(),""!==r&&$(i).append('<option value="">'+r+"</option>");for(var a=0;a<t.length;a++)$(i).append('<option value="'+t[a]+'">'+t[a]+"</option>");break;case"radioselect":case"checkboxselect":i.empty();var l=$(select).attr("id"),o=$(select).attr("name");if("radioselect"==FormField.GetFieldType(i).toLowerCase())var n='<input type="radio" />';else var n='<input type="checkbox" />';for(var a=0;a<t.length;a++){a>0&&$(select).append("<br />");var d=$(select).append("<label>");$(d).attr("for",l+"_"+a);var s=$(d).append(n);$(s).attr("id",l+"_"+a),$(s).attr("name",o+"_["+a+"]"),$(s).val(t[a]),$(d).append(" "+t[a])}}},GetLabel:function(e){var t=FormField.GetFieldDefinitionTag(e);if(!t)return!1;var i=$(".FormFieldLabel",t).text();return i=i.replace(/:/,"")},IsRequired:function(e){var t=FormField.GetFieldDefinitionTag(e);if(!t)return!1;var i=$(".FormFieldRequired",t);return"hidden"==$(i).css("visibility")?!1:!0},SetRequired:function(e,t){var i=FormField.GetField(e);if(dt=FormField.GetFieldDefinitionTag(i),!dt)return!1;var r=$(".FormFieldRequired",dt);return("undefined"==typeof t||t!==!0)&&(t=!1),t?$(r).css("visibility","visible"):$(r).css("visibility","hidden"),!0},SetDisabled:function(e,t){if(e=FormField.GetField(e),!e)return!1;switch(("undefined"==typeof t||t!==!0)&&(status=!1),FormField.GetFieldType(e).toLowerCase()){case"radioselect":case"checkboxselect":$("input",e).each(function(){$(this).attr("disabled",t)});break;default:$(e).attr("disabled",t)}return!0},BindEvent:function(e,t,i,r){if(e=FormField.GetField(e),!e||"undefined"==typeof t||""==t||"function"!=typeof i)return!1;switch("undefined"==typeof r&&(r={fieldId:FormField.GetFieldId(e)}),FormField.GetFieldType(e).toLowerCase()){case"radioselect":case"checkboxselect":$("input",e).each(function(){$(this).bind(t,r,i)});break;default:$(e).bind(t,r,i)}return!0},UnBindEvent:function(e,t,i){if(e=FormField.GetField(e),!e||"undefined"==typeof t||""==t)return!1;switch(FormField.GetFieldType(e).toLowerCase()){case"radioselect":case"checkboxselect":$("input",e).each(function(){$(this).unbind(t,i)});break;default:$(e).unbind(t,i)}return!0},Focus:function(e){if(e=FormField.GetField(e)){var t=null,i=!0;switch(FormField.GetFieldType(e).toLowerCase()){case"radioselect":case"checkboxselect":t=$("input:first",e),i=!1;break;case"datechooser":t=$(".FormFieldMonth",e);break;default:t=e}null!=t&&(i&&$(t).select(),$(t).focus())}},Hide:function(e){var t=FormField.GetFieldDefinitionData(e),i=FormField.GetFieldDefinitionTag(e);return t&&i?($(t).hide(),void $(i).hide()):!1},Show:function(e){var t=FormField.GetFieldDefinitionData(e),i=FormField.GetFieldDefinitionTag(e);return t&&i?($(t).show(),void $(i).show()):!1},Validate:function(e){if(e=FormField.GetField(e),!e)return!1;var t={status:!0,msg:""},i=FormField.GetValue(e),r=FormField.GetFieldType(e).toLowerCase();if(FormField.IsRequired(e)&&""==i&&("selectortext"==r&&$(e).attr("type")&&"text"==$(e).attr("type").toLowerCase()||"password"==r||(t.msg="checkboxselect"==r||"radioselect"==r?lang.CustomFieldsValidationOptionRequired:lang.CustomFieldsValidationRequired)),""==t.msg)switch(r){case"numberonly":if(isNaN(i))t.msg=lang.CustomFieldsValidationNumbersOnly;else{var a=FormField.GetFieldDefinitionData(e),l=$(".FormFieldLimitFrom",a),o=$(".FormFieldLimitTo",a);$(l).length>0&&parseInt(i,10)<parseInt($(l).val(),10)?(t.msg=lang.CustomFieldsValidationNumbersToLow,t.msg=t.msg.replace(/%d/,$(l).val())):$(o).length>0&&parseInt(i,10)>parseInt($(o).val(),10)&&(t.msg=lang.CustomFieldsValidationNumbersToHigh,t.msg=t.msg.replace(/%d/,$(o).val()))}break;case"datechooser":var n=$(".FormFieldDay",e).val(),d=$(".FormFieldMonth",e).val(),s=$(".FormFieldYear",e).val();n+""+d+s==""||""!=n&&""!=d&&""!=s||(t.msg=lang.CustomFieldsValidationDateInvalid);var a=FormField.GetFieldDefinitionData(e),l=$(".FormFieldLimitFrom",a),o=$(".FormFieldLimitTo",a);if(0==$(l).length||0==$(o).length)break;var F=i.split("-"),c=$(l).val().split("-"),u=$(o).val().split("-");jQuery.each(F,function(e){F[e]=parseInt(F[e],10)}),jQuery.each(c,function(e){c[e]=parseInt(c[e],10)}),jQuery.each(u,function(e){u[e]=parseInt(u[e],10)});var f=new Date(F[0],F[1]-1,F[2]),m=new Date(c[0],c[1]-1,c[2]),p=new Date(u[0],u[1]-1,u[2]);f.getTime()<m.getTime()?(t.msg=lang.CustomFieldsValidationDateToLow,t.msg=t.msg.replace(/%s\./,m.toLocaleDateString()+".")):f.getTime()>p.getTime()&&(t.msg=lang.CustomFieldsValidationDateToHigh,t.msg=t.msg.replace(/%s\./,p.toLocaleDateString()+"."));break;case"password":if(FormField.IsRequired(e))if("text"==$(e).attr("type")&&""==i)t.msg=lang.CustomFieldsValidationRequired;else{var a=FormField.GetFieldDefinitionData(e),v=$(".FormFieldAlreadySet",a);0!=$(v).length&&""!=$(v).val()||""!=i||(t.msg=lang.CustomFieldsValidationRequired)}}return""!==t.msg&&(t.msg=t.msg.replace(/'%s'/,"'"+FormField.GetLabel(e)+"'"),t.status=!1),t}},FormFieldEvent={SingleSelectPopulateStates:function(e){var t=e.data.countryId,i=FormField.GetValue(t),r=e.data.stateId,a="",l=!1;if("undefined"!=typeof e.data.selectedState&&(a=e.data.selectedState),"undefined"!=typeof e.data.inOrdersAdmin&&(l=e.data.inOrdersAdmin),""==i){var o={display:"option"};return void FormField.SetValue(r,"",o)}$.ajax({url:"remote.php",type:"post",data:{w:"getStates",countryName:i},success:function(e){if("0"!=$("status",e).text()){var t=[];if($("options option",e).each(function(){t[t.length]=$("name",this).text()}),0==t.length){var i={display:"option"};FormField.SetRequired(r,!1)}else{var i={display:"select",options:t};FormField.SetRequired(r,!0)}if(FormField.SetValue(r,a,i),l&&"undefined"!=typeof OrderManager){var o={data:{fieldId:r}};OrderManager.BindAddressSyncEventsCallback(o)}}}})},CheckBoxShipToAddress:function(e){"undefined"!=typeof e.data.fieldId&&(FormField.GetValue(e.data.fieldId).length>0?($(".billingButton").val(lang.BillAndShipToAddress),$(".shippingButton").val(lang.ShipToThisAddress),$("#ship_to_billing_existing").attr("checked",!0)):($(".billingButton").val(lang.BillToThisAddress),$(".shippingButton").val(lang.ShipToThisAddress),$("#ship_to_billing_existing").attr("checked",!1)))}};$(document).ready(function(){$(".FormField.JSHidden").show()});